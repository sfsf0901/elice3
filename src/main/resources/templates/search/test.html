<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"><head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
í…ŒìŠ¤íŠ¸ í™”ë©´ì…ë‹ˆë‹¤
    <div th:each="diagnosisSubject : ${medicalDepartments}">
        <a th:text="${diagnosisSubject.name}" th:data-department="${diagnosisSubject.name}" onclick="goToSearch(event, this)"></a>
    </div>

    <script>
        function goToSearch(event, element) {
            event.preventDefault(); // ê¸°ë³¸ ì´ë²¤íŠ¸ ë§‰ê¸° (ì¤‘ìš”)

            let department = element.getAttribute("data-department");

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    let latitude = position.coords.latitude;
                    let longitude = position.coords.longitude;

                    let targetUrl = `/search/department?department=${encodeURIComponent(department)}&lat=${latitude}&lng=${longitude}`;
                    console.log("ğŸš€ ë³‘ì› ê²€ìƒ‰ URL:", targetUrl); // ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

                    // ë³‘ì› ê²€ìƒ‰ í˜ì´ì§€ë¡œ ì´ë™
                    window.location.href = targetUrl;
                }, function (error) {
                    alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                });
            } else {
                alert("ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
        }
    </script>
</body>
</html>